{"version":3,"file":"index.js","sources":["../../src/core/activeElement.ts","../../src/core/renderer/index.ts","../../src/core/node/children.ts","../../src/config.ts","../../src/core/utils.ts","../../src/core/node/states.ts","../../node_modules/.pnpm/github.com+pecoram+renderer@a28a5f0d19e5a3a5aacb43f1cead0449d1c4b1c2/node_modules/@lightningjs/renderer/dist/src/utils.js","../../src/core/flex.ts","../../src/core/node/index.ts","../../src/components/Text.tsx","../../src/components/View.tsx","../../src/components/Canvas.tsx","../../node_modules/.pnpm/solid-js@1.8.6/node_modules/solid-js/universal/dist/universal.js","../../src/core/universal/lightning.ts","../../src/core/universal/dom-inspector.ts","../../src/core/render.ts","../../src/utils.ts"],"sourcesContent":["/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { createSignal } from 'solid-js';\nimport type { ElementNode } from './node/index.js';\nexport const [activeElement, setActiveElement] =\n  createSignal<ElementNode | null>(null);\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n  MainRenderDriver,\n  RendererMain,\n  type RendererMainSettings,\n} from '@lightningjs/renderer';\n\nexport let renderer: RendererMain;\nexport let createShader: RendererMain['createShader'];\n\nexport interface SolidRendererOptions extends RendererMainSettings {\n  threadXCoreWorkerUrl?: string;\n  rootId: string | HTMLElement;\n}\n\nexport function startLightningRenderer(\n  options: Partial<SolidRendererOptions> = {},\n): RendererMain {\n  const driver = new MainRenderDriver();\n\n  renderer = new RendererMain(options, options.rootId || 'app', driver);\n\n  createShader = renderer.createShader.bind(renderer);\n  return renderer;\n}\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type { ElementNode, SolidNode } from './index.js';\n\n/**\n * Children class\n */\nexport default class Children extends Array<SolidNode> {\n  _parent: ElementNode;\n\n  constructor(node: ElementNode) {\n    super();\n    this._parent = node;\n  }\n\n  get selected(): ElementNode | undefined {\n    // For selected Elements should always be an ElementNode\n    return this[this._parent.selected || 0] as ElementNode | undefined;\n  }\n\n  get firstChild() {\n    return this[0];\n  }\n\n  insert(node: SolidNode, beforeNode: SolidNode) {\n    if (beforeNode) {\n      const index = this.indexOf(beforeNode);\n      this.splice(index, 0, node);\n    } else {\n      this.push(node);\n    }\n\n    node.parent = this._parent;\n    this._parent._isDirty = true;\n  }\n\n  remove(node: SolidNode) {\n    const nodeIndexToRemove = this.indexOf(node);\n    if (nodeIndexToRemove >= 0) {\n      this.splice(nodeIndexToRemove, 1);\n    }\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2023 Comcast\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { AnimationSettings } from '@lightningjs/renderer';\nimport type { IntrinsicTextNodeStyleProps } from './intrinsicTypes.js';\nimport { type ElementNode } from './core/node/index.js';\n\ninterface Config {\n  debug: boolean;\n  animationSettings: Partial<AnimationSettings>;\n  fontSettings: Partial<IntrinsicTextNodeStyleProps>;\n  stateMapperHook?: (node: ElementNode, states: Array<string>) => Array<string>;\n}\n\nimport.meta.env = import.meta.env || { MODE: 'development' };\nexport const isDev = import.meta.env.MODE === 'development';\n\nexport const config: Config = {\n  debug: false,\n  animationSettings: {\n    duration: 250,\n    easing: 'ease-in-out',\n  },\n  fontSettings: {\n    fontFamily: 'Ubuntu',\n    fontSize: 100,\n  },\n};\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { config, isDev } from '../config.js';\nimport type { AnimatableNumberProp } from '../index.js';\nimport type { SolidNode } from './node/index.js';\n\nexport function log(msg: string, node: SolidNode, ...args: any[]) {\n  if (isDev) {\n    if (config.debug || (isObject(node) && node.debug)) {\n      console.log(msg, node, ...args);\n    }\n  }\n}\n\nexport function isFunc(item: unknown): item is (...args: unknown[]) => unknown {\n  return typeof item === 'function';\n}\n\nexport function isObject(\n  item: unknown,\n): item is Record<string | number | symbol, unknown> {\n  return typeof item === 'object';\n}\n\nexport function isArray(item: unknown): item is any[] {\n  return Array.isArray(item);\n}\n\nexport function isString(item: unknown): item is string {\n  return typeof item === 'string';\n}\n\nexport function isNumber(item: unknown): item is number {\n  return typeof item === 'number';\n}\n\nexport function isInteger(item: unknown): item is number {\n  return Number.isInteger(item);\n}\n\nexport function keyExists(\n  obj: Record<string, unknown>,\n  keys: (string | number | symbol)[],\n) {\n  for (const key of keys) {\n    if (key in obj) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function getAnimatableValue(\n  value: number | AnimatableNumberProp | undefined,\n): number | undefined {\n  return isArray(value) ? (value as AnimatableNumberProp)[0] : value;\n}\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isArray, isString } from '../utils.js';\n\nexport type NodeStates =\n  | string[]\n  | string\n  | Record<string, boolean | undefined>;\n\nexport default class States extends Array<string> {\n  private onChange: () => void;\n\n  constructor(callback: () => void, initialState: NodeStates = {}) {\n    if (isArray(initialState)) {\n      super(...initialState);\n    } else if (isString(initialState)) {\n      super(initialState);\n    } else {\n      super(\n        ...Object.entries(initialState)\n          .filter(([_key, value]) => value)\n          .map(([key]) => key),\n      );\n    }\n\n    this.onChange = callback;\n    return this;\n  }\n\n  has(state: string) {\n    return this.indexOf(state) >= 0;\n  }\n\n  is(state: string) {\n    return this.indexOf(state) >= 0;\n  }\n\n  add(state: string) {\n    this.push(state);\n    this.onChange();\n  }\n\n  toggle(state: string) {\n    if (this.has(state)) {\n      this.remove(state);\n    } else {\n      this.add(state);\n    }\n  }\n\n  remove(state: string) {\n    const stateIndexToRemove = this.indexOf(state);\n    if (stateIndexToRemove >= 0) {\n      this.splice(stateIndexToRemove, 1);\n      this.onChange();\n    }\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2023 Comcast Cable Communications Management, LLC.\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport function createWebGLContext(canvas) {\n    const config = {\n        alpha: true,\n        antialias: false,\n        depth: false,\n        stencil: true,\n        desynchronized: false,\n        failIfMajorPerformanceCaveat: true,\n        powerPreference: 'high-performance',\n        premultipliedAlpha: true,\n        preserveDrawingBuffer: false,\n    };\n    return (\n    // TODO: Remove this assertion once this issue is fixed in TypeScript\n    // https://github.com/microsoft/TypeScript/issues/53614\n    (canvas.getContext('webgl', config) ||\n        canvas.getContext('experimental-webgl', config)));\n}\n/**\n * Asserts a condition is truthy, otherwise throws an error\n *\n * @remarks\n * Useful at the top of functions to ensure certain conditions, arguments and\n * properties are set/met before continuing. When using this function,\n * TypeScript will narrow away falsy types from the condition.\n *\n * @param condition\n * @param message\n * @returns\n */\nexport function assertTruthy(condition, message) {\n    if (!condition) {\n        throw new Error(message || 'Assertion failed');\n    }\n}\n/**\n * Merges two colors based on a given progress value.\n *\n * This function takes two colors (c1 and c2) represented as 32-bit integers\n * in RGBA format and blends them based on the provided progress value (p).\n * The result is a new color that is a weighted combination of the input colors,\n * where the weight is determined by the progress value.\n *\n * @param {number} c1 - The first color in RGBA format (32-bit integer).\n * @param {number} c2 - The second color in RGBA format (32-bit integer).\n * @param {number} p - The progress value between 0 and 1.\n * @returns {number} The merged color as a 32-bit integer in RGBA format.\n */\nexport function mergeColorProgress(rgba1, rgba2, p) {\n    const r1 = Math.trunc(rgba1 >>> 24);\n    const g1 = Math.trunc((rgba1 >>> 16) & 0xff);\n    const b1 = Math.trunc((rgba1 >>> 8) & 0xff);\n    const a1 = Math.trunc(rgba1 & 0xff);\n    const r2 = Math.trunc(rgba2 >>> 24);\n    const g2 = Math.trunc((rgba2 >>> 16) & 0xff);\n    const b2 = Math.trunc((rgba2 >>> 8) & 0xff);\n    const a2 = Math.trunc(rgba2 & 0xff);\n    const r = Math.round(r2 * p + r1 * (1 - p));\n    const g = Math.round(g2 * p + g1 * (1 - p));\n    const b = Math.round(b2 * p + b1 * (1 - p));\n    const a = Math.round(a2 * p + a1 * (1 - p));\n    return ((r << 24) | (g << 16) | (b << 8) | a) >>> 0;\n}\n/**\n * Given an RGBA encoded number, returns back the RGBA number with it's alpha\n * component multiplied by the passed `alpha` parameter.\n *\n * @internalRemarks\n * This method does NOT premultiply the alpha into the color channels. If that\n * is required (for internal use only) use {@link mergeColorAlphaPremultiplied}\n * instead.\n *\n * @param rgba RGBA encoded number\n * @param alpha Normalized alpha value (Range: 0.0 - 1.0)\n * @returns\n */\nexport function mergeColorAlpha(rgba, alpha) {\n    const r = rgba >>> 24;\n    const g = (rgba >>> 16) & 0xff;\n    const b = (rgba >>> 8) & 0xff;\n    const a = Math.trunc((rgba & 0xff) * alpha);\n    return ((r << 24) | (g << 16) | (b << 8) | a) >>> 0;\n}\n/**\n * Given an RGBA encoded number, returns back the RGBA number with it's alpha\n * component multiplied by the passed `alpha` parameter. Before returning, the\n * final alpha value is multiplied into the color channels.\n *\n * @remarks\n * If `flipEndianess` is set to true, the function will returned an ABGR encoded number\n * which is useful when the color value needs to be passed into a shader attribute.\n *\n * NOTE: This method returns a PREMULTIPLIED alpha color which is generally only useful\n * in the context of the internal rendering process. Use {@link mergeColorAlpha} if you\n * need to blend an alpha value into a color in the context of the Renderer's\n * main API.\n *\n * @internalRemarks\n * Do not expose this method in the main API because Renderer users should instead use\n * {@link mergeColorAlpha} to manipulate the alpha value of a color.\n *\n * @internal\n * @param rgba RGBA encoded number\n * @param alpha Normalized alpha value (Range: 0.0 - 1.0)\n * @param flipEndianess Flip the endianess. RGBA becomes encoded as ABGR (for inserting colors into shader attributes)\n * @returns\n */\nexport function mergeColorAlphaPremultiplied(rgba, alpha, flipEndianess = false) {\n    const newAlpha = ((rgba & 0xff) / 255) * alpha;\n    const r = Math.trunc((rgba >>> 24) * newAlpha);\n    const g = Math.trunc(((rgba >>> 16) & 0xff) * newAlpha);\n    const b = Math.trunc(((rgba >>> 8) & 0xff) * newAlpha);\n    const a = Math.trunc(newAlpha * 255);\n    if (flipEndianess) {\n        return ((a << 24) | (b << 16) | (g << 8) | r) >>> 0;\n    }\n    return ((r << 24) | (g << 16) | (b << 8) | a) >>> 0;\n}\n/**\n * Returns true if the given object has the given \"own\" property.\n *\n * @param obj\n * @param prop\n * @returns\n */\nexport function hasOwn(obj, prop) {\n    return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n/**\n * Converts degrees to radians\n *\n * @param degrees\n * @returns\n */\nexport function deg2Rad(degrees) {\n    return (degrees * Math.PI) / 180;\n}\n//# sourceMappingURL=utils.js.map","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { assertTruthy } from '@lightningjs/renderer/utils';\nimport type { ElementNode, SolidNode } from './node/index.js';\n\nexport default function (node: ElementNode) {\n  const children = [];\n  for (let i = 0; i < node.children.length; i++) {\n    const c = node.children[i]!;\n    // Filter empty text nodes which are place holders for <Show> and elements missing dimensions\n    if (c.name === 'TextNode') {\n      continue;\n    }\n    // text node hasnt loaded yet - skip layout\n    if (c.name === 'text' && !(c.width || c.height)) {\n      return;\n    }\n\n    children.push(c);\n  }\n\n  const numChildren = children.length;\n  const direction = node.flexDirection || 'row';\n  const dimension = direction === 'row' ? 'width' : 'height';\n  const crossDimension = direction === 'row' ? 'height' : 'width';\n  const marginOne = direction === 'row' ? 'marginLeft' : 'marginTop';\n  const marginTwo = direction === 'row' ? 'marginRight' : 'marginBottom';\n  const prop = direction === 'row' ? 'x' : 'y';\n  const crossProp = direction === 'row' ? 'y' : 'x';\n  const containerSize = node[dimension] || 0;\n  const containerCrossSize = node[crossDimension] || 0;\n  const itemSize = children.reduce((prev, c) => prev + (c[dimension] || 0), 0);\n  const gap = node.gap || 0;\n  const justify = node.justifyContent || 'flexStart';\n  const align = node.alignItems;\n\n  // Only align children if container has a cross size\n  const crossAlignChild =\n    containerCrossSize && align\n      ? (c: SolidNode) => {\n          if (align === 'flexStart') {\n            c[crossProp] = 0;\n          } else if (align === 'center') {\n            c[crossProp] = (containerCrossSize - (c[crossDimension] || 0)) / 2;\n          } else if (align === 'flexEnd') {\n            c[crossProp] = containerCrossSize - (c[crossDimension] || 0);\n          }\n        }\n      : (c: SolidNode) => c;\n\n  if (justify === 'flexStart') {\n    let start = 0;\n    children.forEach((c) => {\n      c[prop] = start + (c[marginOne] || 0);\n      start +=\n        (c[dimension] || 0) + gap + (c[marginOne] || 0) + (c[marginTwo] || 0);\n      crossAlignChild(c);\n    });\n  }\n  if (justify === 'flexEnd') {\n    let start = containerSize;\n    for (let i = numChildren - 1; i >= 0; i--) {\n      const c = children[i];\n      assertTruthy(c);\n      c[prop] = start - (c[dimension] || 0) - (c[marginTwo] || 0);\n      start -=\n        (c[dimension] || 0) + gap + (c[marginOne] || 0) + (c[marginTwo] || 0);\n      crossAlignChild(c);\n    }\n  }\n  if (justify === 'center') {\n    let start = (containerSize - (itemSize + gap * (numChildren - 1))) / 2;\n    children.forEach((c) => {\n      c[prop] = start;\n      start += (c[dimension] || 0) + gap;\n      crossAlignChild(c);\n    });\n  }\n  if (justify === 'spaceBetween') {\n    const toPad = (containerSize - itemSize) / (numChildren - 1);\n    let start = 0;\n    children.forEach((c) => {\n      c[prop] = start;\n      start += (c[dimension] || 0) + toPad;\n      crossAlignChild(c);\n    });\n  }\n  if (justify === 'spaceEvenly') {\n    const toPad = (containerSize - itemSize) / (numChildren + 1);\n    let start = toPad;\n    children.forEach((c) => {\n      c[prop] = start;\n      start += (c[dimension] || 0) + toPad;\n      crossAlignChild(c);\n    });\n  }\n}\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { renderer, createShader } from '../renderer/index.js';\nimport {\n  type AnimatableNumberProp,\n  type BorderStyleObject,\n  type IntrinsicCommonProps,\n  type NodeStyles,\n  type TextStyles,\n} from '../../index.js';\nimport Children from './children.js';\nimport States, { type NodeStates } from './states.js';\nimport calculateFlex from '../flex.js';\nimport {\n  log,\n  isArray,\n  isNumber,\n  isFunc,\n  keyExists,\n  getAnimatableValue,\n} from '../utils.js';\nimport { config } from '../../config.js';\nimport { setActiveElement } from '../activeElement.js';\nimport type {\n  INode,\n  INodeAnimatableProps,\n  INodeWritableProps,\n  ShaderRef,\n  Dimensions,\n  AnimationSettings,\n  NodeLoadedPayload,\n} from '@lightningjs/renderer';\nimport { assertTruthy } from '@lightningjs/renderer/utils';\n\nconst { animationSettings: defaultAnimationSettings } = config;\n\nfunction convertEffectsToShader(styleEffects: any) {\n  const effects = [];\n\n  for (const [type, props] of Object.entries<Record<string, any>>(\n    styleEffects,\n  )) {\n    effects.push({ type, props });\n  }\n  return createShader('DynamicShader', { effects: effects as any });\n}\n\nfunction borderAccessor(\n  direction: '' | 'Top' | 'Right' | 'Bottom' | 'Left' = '',\n) {\n  return {\n    set(this: ElementNode, value: number | { width: number; color: number }) {\n      // Format: width || { width, color }\n      if (isNumber(value)) {\n        value = { width: value, color: 0x000000ff };\n      }\n      this.effects = {\n        ...(this.effects || {}),\n        ...{ [`border${direction}`]: value },\n      };\n      this[`_border${direction}`] = value;\n    },\n    get(this: ElementNode) {\n      return this[`_border${direction}`];\n    },\n  };\n}\n\nconst LightningRendererNumberProps = [\n  'alpha',\n  'color',\n  'colorTop',\n  'colorRight',\n  'colorLeft',\n  'colorBottom',\n  'colorTl',\n  'colorTr',\n  'colorBl',\n  'colorBr',\n  'height',\n  'fontSize',\n  'lineHeight',\n  'mount',\n  'mountX',\n  'mountY',\n  'pivot',\n  'pivotX',\n  'pivotY',\n  'rotation',\n  'scale',\n  'width',\n  'worldX',\n  'worldY',\n  'x',\n  'y',\n  'zIndex',\n  'zIndexLocked',\n];\n\nconst LightningRendererNonAnimatingProps = [\n  'clipping',\n  'contain',\n  'fontFamily',\n  'src',\n  'text',\n  'textAlign',\n  'texture',\n  'maxLines',\n  'maxLinesSuffix',\n  'textOverflow',\n  'verticalAling',\n  'textBaseline',\n  'wordWrap',\n];\n\nexport interface TextNode {\n  name: string;\n  text: string;\n  parent: ElementNode | null;\n  zIndex?: number;\n  states?: States;\n  x?: number;\n  y?: number;\n  width?: number;\n  height?: number;\n  marginLeft?: number;\n  marginRight?: number;\n  marginTop?: number;\n  marginBottom?: number;\n  /**\n   * Managed by dom-inspector\n   */\n  _dom?: Text; // Public but uses _ prefix\n}\n\nexport type SolidNode = ElementNode | TextNode;\nexport type SolidStyles = NodeStyles | TextStyles;\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-declaration-merging\nexport interface ElementNode\n  extends Partial<Omit<INodeWritableProps, 'parent' | 'shader'>>,\n    IntrinsicCommonProps {\n  [key: string]: unknown;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-declaration-merging\nexport class ElementNode extends Object {\n  name: string;\n  lng: INode | null = null;\n  selected?: number;\n  rendered: boolean;\n  autofocus: boolean;\n\n  private _undoStates?: Record<string, any>;\n  private _renderProps: any;\n  private _effects: any;\n  private _parent: ElementNode | null = null;\n  private _shader?: ShaderRef;\n  private _style?: SolidStyles;\n  private _states?: States;\n  private _animationSettings?: Partial<AnimationSettings>;\n  private _width?: number;\n  private _height?: number;\n  private _color?: number;\n  private _borderRadius?: number;\n  private _border?: BorderStyleObject;\n  private _borderLeft?: BorderStyleObject;\n  private _borderRight?: BorderStyleObject;\n  private _borderTop?: BorderStyleObject;\n  private _borderBottom?: BorderStyleObject;\n  public _animate?: boolean; // Public but uses _ prefix\n  public _autosized?: boolean; // Public but uses _ prefix\n  public _isDirty?: boolean; // Public but uses _ prefix\n  /**\n   * Managed by dom-inspector\n   */\n  public _dom?: HTMLDivElement; // Public but uses _ prefix\n  children: Children;\n\n  constructor(name: string) {\n    super();\n    this.name = name;\n    this.rendered = false;\n    this.autofocus = false;\n    this._renderProps = { x: 0, y: 0 };\n    this.children = new Children(this);\n\n    for (const key of LightningRendererNumberProps) {\n      Object.defineProperty(this, key, {\n        get(): number {\n          return this[`_${key}`] || (this.lng && this.lng[key]);\n        },\n        set(v: number | AnimatableNumberProp) {\n          this[`_${key}`] = getAnimatableValue(v);\n          this._sendToLightningAnimatable(key, v);\n        },\n      });\n    }\n\n    for (const key of LightningRendererNonAnimatingProps) {\n      Object.defineProperty(this, key, {\n        get() {\n          return this[`_${key}`] || (this.lng && this.lng[key]);\n        },\n        set(v) {\n          this[`_${key}`] = v;\n          this._sendToLightning(key, v);\n        },\n      });\n    }\n\n    // Add Border Helpers\n    Object.defineProperties(this, {\n      borderRadius: {\n        set(this: ElementNode, radius) {\n          this._borderRadius = radius;\n          this.effects = {\n            ...(this.effects || {}),\n            ...{ radius: { radius } },\n          };\n        },\n        get(this: ElementNode) {\n          return this._borderRadius;\n        },\n      },\n      border: borderAccessor(),\n      borderLeft: borderAccessor('Left'),\n      borderRight: borderAccessor('Right'),\n      borderTop: borderAccessor('Top'),\n      borderBottom: borderAccessor('Bottom'),\n    });\n\n    Object.defineProperties(this, {\n      linearGradient: {\n        set(props = {}) {\n          this._linearGradient = props;\n          this.effects = {\n            ...(this.effects || {}),\n            ...{ linearGradient: props },\n          };\n        },\n        get() {\n          return this._linearGradient;\n        },\n      },\n    });\n  }\n\n  get effects() {\n    return this._effects;\n  }\n\n  set effects(v) {\n    this._effects = v;\n    this.shader = convertEffectsToShader(v);\n  }\n\n  get parent() {\n    return this._parent;\n  }\n\n  set parent(p) {\n    this._parent = p;\n    if (this.rendered && this.lng) {\n      this.lng.parent = p?.lng ?? null;\n    }\n  }\n\n  get shader(): ShaderRef | undefined {\n    return this._shader;\n  }\n\n  set shader(v: Parameters<typeof createShader> | ShaderRef | undefined) {\n    if (isArray(v)) {\n      this._shader = createShader(...v) as ShaderRef;\n    } else {\n      this._shader = v;\n    }\n    this._sendToLightning('shader', this._shader);\n  }\n\n  _sendToLightningAnimatable(\n    name: string,\n    value: AnimatableNumberProp | number | string,\n  ) {\n    if (this.rendered && this.lng) {\n      if (isArray(value)) {\n        return this.createAnimation({ [name]: value[0] }, value[1]).start();\n      }\n\n      if (this._animate) {\n        return this.createAnimation({ [name]: value }).start();\n      }\n\n      (this.lng[name as keyof INode] as number | string) = value;\n    } else {\n      // Need to render before animating\n      if (isArray(value)) {\n        value = value[0];\n      }\n      this._renderProps[name] = value;\n    }\n  }\n\n  _sendToLightning(name: string, value: unknown) {\n    if (this.rendered && this.lng) {\n      (this.lng[name as keyof INodeWritableProps] as unknown) = value;\n    } else {\n      this._renderProps[name] = value;\n    }\n  }\n\n  createAnimation(\n    props: Partial<INodeAnimatableProps>,\n    animationSettings?: Partial<AnimationSettings>,\n  ) {\n    assertTruthy(this.lng, 'Node must be rendered before animating');\n    return this.lng.animate(props, animationSettings || this.animationSettings);\n  }\n\n  setFocus() {\n    if (this.rendered) {\n      setActiveElement<ElementNode>(this);\n    } else {\n      this.autofocus = true;\n    }\n  }\n\n  isTextNode() {\n    return this.name === 'text';\n  }\n\n  _resizeOnTextLoad() {\n    this.lng!.once(\n      'loaded',\n      (_node: INode, loadedPayload: NodeLoadedPayload) => {\n        if (loadedPayload.type === 'text') {\n          const { dimensions } = loadedPayload;\n\n          this.width = dimensions.width;\n          this.height = dimensions.height;\n          this.parent!.updateLayout(this, dimensions);\n        }\n      },\n    );\n  }\n\n  getText() {\n    return this.children.map((c) => c.text).join('');\n  }\n\n  destroy() {\n    this.lng && renderer.destroyNode(this.lng);\n  }\n\n  set style(value: SolidStyles) {\n    // Keys set in JSX are more important\n    for (let key in value) {\n      if (key === 'animate') {\n        key = '_animate';\n      }\n\n      if (!this[key as keyof SolidStyles]) {\n        this[key as keyof SolidStyles] = value[key as keyof SolidStyles];\n      }\n    }\n\n    this._style = value;\n  }\n\n  get style(): SolidStyles {\n    return this._style!;\n  }\n\n  get hasChildren() {\n    return this.children.length > 0;\n  }\n\n  set states(states: NodeStates) {\n    this._states = new States(this._stateChanged.bind(this), states);\n    if (this.rendered) {\n      this._stateChanged();\n    }\n  }\n\n  get states(): States {\n    this._states = this._states || new States(this._stateChanged.bind(this));\n    return this._states;\n  }\n\n  get animationSettings(): Partial<AnimationSettings> {\n    return this._animationSettings || defaultAnimationSettings;\n  }\n\n  set animationSettings(animationSettings: Partial<AnimationSettings>) {\n    this._animationSettings = animationSettings;\n  }\n\n  _applyZIndexToChildren() {\n    const zIndex = this.zIndex!;\n    const zIndexIsInteger = zIndex >= 1 && parseInt('' + zIndex) === zIndex;\n    const decimalSeparator = zIndexIsInteger ? '.' : '';\n\n    this.children.forEach((c, i) => {\n      if (!c.zIndex || c.zIndex < 1) {\n        c.zIndex = parseFloat(`${zIndex}${decimalSeparator}${i + 1}`);\n      }\n    });\n  }\n\n  updateLayout(child?: ElementNode, dimensions?: Dimensions) {\n    if (this.hasChildren) {\n      log('Layout: ', this);\n      isFunc(this.onBeforeLayout) &&\n        this.onBeforeLayout.call(this, child, dimensions);\n\n      if (this.display === 'flex') {\n        calculateFlex(this);\n      }\n\n      isFunc(this.onLayout) && this.onLayout.call(this, child, dimensions);\n    }\n  }\n\n  _stateChanged() {\n    log('State Changed: ', this, this.states);\n\n    if (this.forwardStates) {\n      // apply states to children first\n      const states = this.states.slice() as States;\n      this.children.forEach((c) => (c.states = states));\n    }\n\n    const states = config.stateMapperHook?.(this, this.states) || this.states;\n\n    if (this._undoStates || (this.style && keyExists(this.style, states))) {\n      this._undoStates = this._undoStates || {};\n      let stylesToUndo = {};\n\n      for (const [state, undoStyles] of Object.entries(this._undoStates)) {\n        // if state is no longer in the states undo it\n        if (!states.includes(state)) {\n          stylesToUndo = {\n            ...stylesToUndo,\n            ...undoStyles,\n          };\n        }\n      }\n\n      const newStyles = states.reduce((acc, state) => {\n        const styles = this.style[state];\n        if (styles) {\n          acc = {\n            ...acc,\n            ...styles,\n          };\n\n          // get current values to undo state\n          if (this._undoStates && !this._undoStates[state]) {\n            this._undoStates[state] = {};\n            Object.keys(styles).forEach((key) => {\n              this._undoStates![state][key] = this[key as keyof this];\n            });\n          }\n        }\n        return acc;\n      }, {});\n\n      // Apply the styles\n      Object.assign(this, { ...stylesToUndo, ...newStyles });\n    }\n  }\n\n  render() {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const node = this;\n    const parent = this.parent!;\n\n    // Parent is dirty whenever a node is inserted after initial render\n    if (parent._isDirty) {\n      parent.updateLayout();\n      parent._applyZIndexToChildren();\n      parent._isDirty = false;\n    }\n\n    node.updateLayout();\n\n    if (this.states.length) {\n      this._stateChanged();\n    }\n\n    let props = node._renderProps;\n\n    if (parent.lng) {\n      props.parent = parent.lng;\n    }\n\n    if (node.isTextNode()) {\n      props = {\n        ...config.fontSettings,\n        ...props,\n        text: node.getText(),\n      };\n      log('Rendering: ', this, props);\n      node.lng = renderer.createTextNode(props);\n\n      isFunc(this.onCreate) && this.onCreate.call(this, node);\n\n      if (isFunc(node.onLoad)) {\n        node.lng.on('loaded', node.onLoad);\n      }\n\n      if (!node.width || !node.height) {\n        node._autosized = true;\n        node._resizeOnTextLoad();\n      }\n    } else {\n      // If its not an image or texture apply some defaults\n      if (!(props.src || props.texture)) {\n        // Set width and height to parent less offset\n        if (isNaN(props.width)) {\n          props.width = (parent.width || 0) - props.x;\n          node._width = props.width;\n        }\n\n        if (isNaN(props.height)) {\n          props.height = (parent.height || 0) - props.y;\n          node._height = props.height;\n        }\n\n        if (!props.color) {\n          // Default color to transparent - If you later set a src, you'll need\n          // to set color '#ffffffff'\n          node._color = props.color = 0x00000000;\n        }\n      }\n\n      log('Rendering: ', this, props);\n      node.hasChildren && node._applyZIndexToChildren();\n      node.lng = renderer.createNode(props);\n\n      if (node.onFail) {\n        node.lng.on('failed', node.onFail);\n      }\n\n      if (node.onLoad) {\n        node.lng.on('loaded', node.onLoad);\n      }\n\n      isFunc(this.onCreate) && this.onCreate.call(this, node);\n    }\n\n    node.rendered = true;\n    node.autofocus && node.setFocus();\n    // clean up after first render;\n    delete this._renderProps;\n  }\n}\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { type Component } from \"solid-js\";\nimport type { IntrinsicTextProps } from \"../intrinsicTypes.js\";\n\nexport const Text: Component<IntrinsicTextProps> = (props) => <text {...props}></text>\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { type Component } from \"solid-js\";\nimport { type IntrinsicNodeProps } from \"../intrinsicTypes.js\";\n\nexport const View: Component<IntrinsicNodeProps> = (props) =>\n   <node {...props}></node>;\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { createEffect, type JSX } from \"solid-js\";\nimport { startLightningRenderer, type SolidRendererOptions } from '../core/renderer/index.js';\nimport { assertTruthy } from \"@lightningjs/renderer/utils\";\nimport { ElementNode, type SolidNode } from \"../core/node/index.js\";\nimport { isFunc } from \"../core/utils.js\";\n\nfunction renderTopDown(node: SolidNode) {\n  if (node.name === 'TextNode') {\n    return;\n  }\n  assertTruthy(node instanceof ElementNode);\n  node.render();\n  node.children.forEach(c => renderTopDown(c))\n}\n\nexport interface CanvasOptions {\n  coreExtensionModule?: string,\n  threadXCoreWorkerUrl?: string,\n}\n\nexport interface CanvasProps {\n  options?: Partial<SolidRendererOptions>;\n  onFirstRender?: (callback: () => void) => void;\n  children?: JSX.Element;\n  ref?: (el: ElementNode) => void;\n}\n\nexport const Canvas = (props: CanvasProps) => {\n  const renderer = startLightningRenderer(props.options);\n  const init = renderer.init();\n  let root: ElementNode | undefined;\n\n  createEffect(() => {\n    init.then(() => {\n      assertTruthy(root);\n      root.lng = renderer.root;\n      root.children.forEach(renderTopDown);\n      isFunc(props.onFirstRender) && props.onFirstRender(root);\n    }).catch(console.error);\n  })\n  return (\n    <canvas ref={root} zIndex={0.1}>\n      {props.children}\n    </canvas>\n  )\n};\n","import {\n  createRoot,\n  createRenderEffect,\n  mergeProps,\n  createMemo,\n  createComponent,\n  untrack\n} from \"solid-js\";\n\nfunction createRenderer$1({\n  createElement,\n  createTextNode,\n  isTextNode,\n  replaceText,\n  insertNode,\n  removeNode,\n  setProperty,\n  getParentNode,\n  getFirstChild,\n  getNextSibling\n}) {\n  function insert(parent, accessor, marker, initial) {\n    if (marker !== undefined && !initial) initial = [];\n    if (typeof accessor !== \"function\") return insertExpression(parent, accessor, initial, marker);\n    createRenderEffect(current => insertExpression(parent, accessor(), current, marker), initial);\n  }\n  function insertExpression(parent, value, current, marker, unwrapArray) {\n    while (typeof current === \"function\") current = current();\n    if (value === current) return current;\n    const t = typeof value,\n      multi = marker !== undefined;\n    if (t === \"string\" || t === \"number\") {\n      if (t === \"number\") value = value.toString();\n      if (multi) {\n        let node = current[0];\n        if (node && isTextNode(node)) {\n          replaceText(node, value);\n        } else node = createTextNode(value);\n        current = cleanChildren(parent, current, marker, node);\n      } else {\n        if (current !== \"\" && typeof current === \"string\") {\n          replaceText(getFirstChild(parent), (current = value));\n        } else {\n          cleanChildren(parent, current, marker, createTextNode(value));\n          current = value;\n        }\n      }\n    } else if (value == null || t === \"boolean\") {\n      current = cleanChildren(parent, current, marker);\n    } else if (t === \"function\") {\n      createRenderEffect(() => {\n        let v = value();\n        while (typeof v === \"function\") v = v();\n        current = insertExpression(parent, v, current, marker);\n      });\n      return () => current;\n    } else if (Array.isArray(value)) {\n      const array = [];\n      if (normalizeIncomingArray(array, value, unwrapArray)) {\n        createRenderEffect(\n          () => (current = insertExpression(parent, array, current, marker, true))\n        );\n        return () => current;\n      }\n      if (array.length === 0) {\n        const replacement = cleanChildren(parent, current, marker);\n        if (multi) return (current = replacement);\n      } else {\n        if (Array.isArray(current)) {\n          if (current.length === 0) {\n            appendNodes(parent, array, marker);\n          } else reconcileArrays(parent, current, array);\n        } else if (current == null || current === \"\") {\n          appendNodes(parent, array);\n        } else {\n          reconcileArrays(parent, (multi && current) || [getFirstChild(parent)], array);\n        }\n      }\n      current = array;\n    } else {\n      if (Array.isArray(current)) {\n        if (multi) return (current = cleanChildren(parent, current, marker, value));\n        cleanChildren(parent, current, null, value);\n      } else if (current == null || current === \"\" || !getFirstChild(parent)) {\n        insertNode(parent, value);\n      } else replaceNode(parent, value, getFirstChild(parent));\n      current = value;\n    }\n    return current;\n  }\n  function normalizeIncomingArray(normalized, array, unwrap) {\n    let dynamic = false;\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i],\n        t;\n      if (item == null || item === true || item === false);\n      else if (Array.isArray(item)) {\n        dynamic = normalizeIncomingArray(normalized, item) || dynamic;\n      } else if ((t = typeof item) === \"string\" || t === \"number\") {\n        normalized.push(createTextNode(item));\n      } else if (t === \"function\") {\n        if (unwrap) {\n          while (typeof item === \"function\") item = item();\n          dynamic =\n            normalizeIncomingArray(normalized, Array.isArray(item) ? item : [item]) || dynamic;\n        } else {\n          normalized.push(item);\n          dynamic = true;\n        }\n      } else normalized.push(item);\n    }\n    return dynamic;\n  }\n  function reconcileArrays(parentNode, a, b) {\n    let bLength = b.length,\n      aEnd = a.length,\n      bEnd = bLength,\n      aStart = 0,\n      bStart = 0,\n      after = getNextSibling(a[aEnd - 1]),\n      map = null;\n    while (aStart < aEnd || bStart < bEnd) {\n      if (a[aStart] === b[bStart]) {\n        aStart++;\n        bStart++;\n        continue;\n      }\n      while (a[aEnd - 1] === b[bEnd - 1]) {\n        aEnd--;\n        bEnd--;\n      }\n      if (aEnd === aStart) {\n        const node =\n          bEnd < bLength ? (bStart ? getNextSibling(b[bStart - 1]) : b[bEnd - bStart]) : after;\n        while (bStart < bEnd) insertNode(parentNode, b[bStart++], node);\n      } else if (bEnd === bStart) {\n        while (aStart < aEnd) {\n          if (!map || !map.has(a[aStart])) removeNode(parentNode, a[aStart]);\n          aStart++;\n        }\n      } else if (a[aStart] === b[bEnd - 1] && b[bStart] === a[aEnd - 1]) {\n        const node = getNextSibling(a[--aEnd]);\n        insertNode(parentNode, b[bStart++], getNextSibling(a[aStart++]));\n        insertNode(parentNode, b[--bEnd], node);\n        a[aEnd] = b[bEnd];\n      } else {\n        if (!map) {\n          map = new Map();\n          let i = bStart;\n          while (i < bEnd) map.set(b[i], i++);\n        }\n        const index = map.get(a[aStart]);\n        if (index != null) {\n          if (bStart < index && index < bEnd) {\n            let i = aStart,\n              sequence = 1,\n              t;\n            while (++i < aEnd && i < bEnd) {\n              if ((t = map.get(a[i])) == null || t !== index + sequence) break;\n              sequence++;\n            }\n            if (sequence > index - bStart) {\n              const node = a[aStart];\n              while (bStart < index) insertNode(parentNode, b[bStart++], node);\n            } else replaceNode(parentNode, b[bStart++], a[aStart++]);\n          } else aStart++;\n        } else removeNode(parentNode, a[aStart++]);\n      }\n    }\n  }\n  function cleanChildren(parent, current, marker, replacement) {\n    if (marker === undefined) {\n      let removed;\n      while ((removed = getFirstChild(parent))) removeNode(parent, removed);\n      replacement && insertNode(parent, replacement);\n      return \"\";\n    }\n    const node = replacement || createTextNode(\"\");\n    if (current.length) {\n      let inserted = false;\n      for (let i = current.length - 1; i >= 0; i--) {\n        const el = current[i];\n        if (node !== el) {\n          const isParent = getParentNode(el) === parent;\n          if (!inserted && !i)\n            isParent ? replaceNode(parent, node, el) : insertNode(parent, node, marker);\n          else isParent && removeNode(parent, el);\n        } else inserted = true;\n      }\n    } else insertNode(parent, node, marker);\n    return [node];\n  }\n  function appendNodes(parent, array, marker) {\n    for (let i = 0, len = array.length; i < len; i++) insertNode(parent, array[i], marker);\n  }\n  function replaceNode(parent, newNode, oldNode) {\n    insertNode(parent, newNode, oldNode);\n    removeNode(parent, oldNode);\n  }\n  function spreadExpression(node, props, prevProps = {}, skipChildren) {\n    props || (props = {});\n    if (!skipChildren) {\n      createRenderEffect(\n        () => (prevProps.children = insertExpression(node, props.children, prevProps.children))\n      );\n    }\n    createRenderEffect(() => props.ref && props.ref(node));\n    createRenderEffect(() => {\n      for (const prop in props) {\n        if (prop === \"children\" || prop === \"ref\") continue;\n        const value = props[prop];\n        if (value === prevProps[prop]) continue;\n        setProperty(node, prop, value, prevProps[prop]);\n        prevProps[prop] = value;\n      }\n    });\n    return prevProps;\n  }\n  return {\n    render(code, element) {\n      let disposer;\n      createRoot(dispose => {\n        disposer = dispose;\n        insert(element, code());\n      });\n      return disposer;\n    },\n    insert,\n    spread(node, accessor, skipChildren) {\n      if (typeof accessor === \"function\") {\n        createRenderEffect(current => spreadExpression(node, accessor(), current, skipChildren));\n      } else spreadExpression(node, accessor, undefined, skipChildren);\n    },\n    createElement,\n    createTextNode,\n    insertNode,\n    setProp(node, name, value, prev) {\n      setProperty(node, name, value, prev);\n      return value;\n    },\n    mergeProps,\n    effect: createRenderEffect,\n    memo: createMemo,\n    createComponent,\n    use(fn, element, arg) {\n      return untrack(() => fn(element, arg));\n    }\n  };\n}\n\nfunction createRenderer(options) {\n  const renderer = createRenderer$1(options);\n  renderer.mergeProps = mergeProps;\n  return renderer;\n}\n\nexport { createRenderer };\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { assertTruthy } from '@lightningjs/renderer/utils';\nimport { renderer } from '../renderer/index.js';\nimport { createEffect } from 'solid-js';\nimport { log } from '../utils.js';\nimport { ElementNode, type SolidNode, type TextNode } from '../node/index.js';\nimport type { createRenderer } from 'solid-js/universal';\n\nexport type SolidRendererOptions = Parameters<\n  typeof createRenderer<SolidNode>\n>[0];\n\nexport default {\n  createElement(name: string): ElementNode {\n    const node = new ElementNode(name);\n    renderer.root && createEffect(() => node.render());\n    return node;\n  },\n  createTextNode(text: string): TextNode {\n    // A text node is just a string - not the <text> node\n    return { name: 'TextNode', text, parent: null };\n  },\n  replaceText(node: TextNode, value: string): void {\n    log('Replace Text: ', node, value);\n    node.text = value;\n    const parent = node.parent;\n    assertTruthy(parent);\n    parent._autosized && parent._resizeOnTextLoad();\n    parent.text = parent.getText();\n  },\n  setProperty(node: ElementNode, name: string, value: any = true): void {\n    if (name === 'animate') {\n      node._animate = value as boolean;\n      return;\n    }\n\n    node[name] = value;\n  },\n  insertNode(parent: ElementNode, node: SolidNode, anchor: SolidNode): void {\n    log('INSERT: ', parent, node, anchor);\n    if (parent) {\n      parent.children.insert(node, anchor);\n\n      if (node.name === 'TextNode') {\n        // TextNodes can be placed outside of <text> nodes when <Show> is used as placeholder\n        if (parent.isTextNode()) {\n          parent._autosized && parent._resizeOnTextLoad();\n          parent.text = parent.getText();\n        }\n      }\n    }\n  },\n  isTextNode(node: ElementNode): boolean {\n    return node.isTextNode();\n  },\n  removeNode(parent: ElementNode, node: SolidNode): void {\n    log('REMOVE: ', parent, node);\n    parent.children.remove(node);\n    if (node instanceof ElementNode) {\n      node.destroy();\n    }\n  },\n  getParentNode(node: SolidNode): ElementNode | undefined {\n    return node.parent ?? undefined;\n  },\n  getFirstChild(node: ElementNode): SolidNode | undefined {\n    return node.children[0];\n  },\n  getNextSibling(node: SolidNode): SolidNode | undefined {\n    if (node.parent) {\n      const children = node.parent.children || [];\n      const index = children.indexOf(node) + 1;\n      if (index < children.length) {\n        return children[index];\n      }\n    }\n    return undefined;\n  },\n} satisfies SolidRendererOptions;\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport universalLightning, { type SolidRendererOptions } from './lightning.js';\nimport { renderer } from '../renderer/index.js';\nimport type { ElementNode, SolidNode, TextNode } from '../node/index.js';\nimport { assertTruthy } from '@lightningjs/renderer/utils';\n\nconst injectCSS = (css: string) => {\n  const el = document.createElement('style');\n  el.innerText = css;\n  document.head.appendChild(el);\n};\n\nconst updateRootStyleFromCanvas = function (canvas: HTMLCanvasElement) {\n  const bcr = canvas.getBoundingClientRect();\n  const p = renderer.settings.deviceLogicalPixelRatio || 1; //0.6666667;\n  const root = document.getElementById('linspector') as HTMLDivElement;\n  root.style.left = canvas.offsetLeft + 'px';\n  root.style.top = canvas.offsetTop + 'px';\n  root.style.width = Math.ceil(bcr.width / p) + 'px';\n  root.style.height = Math.ceil(bcr.height / p) + 'px';\n  root.style.transformOrigin = '0 0 0';\n  root.style.transform = 'scale(' + p + ',' + p + ')';\n};\n\nexport function attachInspector() {\n  injectCSS(`\n    #linspector {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      zIndex: 5;\n      overflow: hidden;\n    }\n    div.lnode {\n      position: absolute;\n      display: inline-block;\n    }\n    .ltext {\n      visibility: hidden;\n    }\n  `);\n\n  setTimeout(function () {\n    updateRootStyleFromCanvas(renderer.canvas);\n  }, 1000);\n}\n\nexport default {\n  ...universalLightning,\n  createElement(name: string) {\n    const dom = document.createElement('div');\n\n    if (name === 'canvas') {\n      dom.id = 'linspector';\n      assertTruthy(renderer.canvas.parentNode);\n      renderer.canvas.parentNode.appendChild(dom);\n    } else {\n      dom.classList.add('lnode');\n    }\n\n    if (name === 'text') {\n      dom.classList.add('ltext');\n    }\n    const node = universalLightning.createElement(name);\n    if (name !== 'canvas') {\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      const origRender = node.render;\n      node.render = () => {\n        origRender.call(node);\n        if (node.id) {\n          dom.id = node.id;\n        }\n        if (node.clipping) {\n          dom.style.overflow = 'hidden';\n        }\n        dom.style.width = node.width + 'px';\n        dom.style.height = node.height + 'px';\n        dom.style.top = node.y + 'px';\n        dom.style.left = node.x + 'px';\n        dom.style.zIndex = `${node.zIndex}`;\n      };\n    }\n    node._dom = dom;\n    // TODO: WeakMap might be a good idea instead augmenting properties onto HTMLDivElement\n    (dom as any).solid = node;\n    return node;\n  },\n  setProperty(node: ElementNode, name: string, value: any = true): void {\n    if (name === 'width') {\n      node._dom!.style.width = value + 'px';\n    } else if (name === 'height') {\n      node._dom!.style.height = value + 'px';\n    } else if (name === 'y') {\n      node._dom!.style.top = value + 'px';\n    } else if (name === 'x') {\n      node._dom!.style.left = value + 'px';\n    } else if (name === 'zIndex') {\n      node._dom!.style.zIndex = value;\n    }\n    universalLightning.setProperty(node, name, value);\n  },\n  createTextNode(text: string): TextNode {\n    const dom = document.createTextNode(text);\n    const node = universalLightning.createTextNode(text);\n    node._dom = dom;\n    return node;\n  },\n  replaceText(textNode: TextNode, value: string): void {\n    universalLightning.replaceText(textNode, value);\n    textNode._dom!.data = value;\n  },\n  insertNode(parent: ElementNode, node: SolidNode, anchor: SolidNode): void {\n    if (parent) {\n      if (anchor && parent._dom === anchor._dom!.parentNode) {\n        parent._dom.insertBefore(node._dom!, anchor._dom!);\n      } else {\n        parent._dom!.appendChild(node._dom!);\n      }\n      universalLightning.insertNode(parent, node, anchor);\n    }\n  },\n  removeNode(parent: ElementNode, node: SolidNode): void {\n    parent._dom!.removeChild(node._dom!);\n    universalLightning.removeNode(parent, node);\n  },\n} satisfies SolidRendererOptions;\n","/* eslint-disable @typescript-eslint/unbound-method */\n/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { createRenderer } from 'solid-js/universal';\nimport universalLightning from './universal/lightning.js';\nimport universalInspector, {\n  attachInspector,\n} from './universal/dom-inspector.js';\nimport type { SolidNode } from './node/index.js';\nimport type { JSX } from 'solid-js';\nimport { isDev } from '../config.js';\n\nconst loadInspector = isDev;\nif (loadInspector) {\n  attachInspector();\n}\nconst solidRenderer = createRenderer<SolidNode>(\n  loadInspector ? universalInspector : universalLightning,\n);\n\n// TODO: This is a hack to get the `render()` function to work as it is used now in the demo app\n// There's gotta be a better way to fix it\nexport const render = solidRenderer.render as unknown as (\n  code: () => JSX.Element,\n  node?: SolidNode,\n) => () => void;\n\nexport const {\n  effect,\n  memo,\n  createComponent,\n  createElement,\n  createTextNode,\n  insertNode,\n  insert,\n  spread,\n  setProp,\n  mergeProps,\n  use,\n} = solidRenderer;\n","/*\n * Copyright 2023 Comcast Cable Communications Management, LLC\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isInteger } from './core/utils.js';\n\n/**\n * Converts a color string to a color number value.\n */\nexport function hexColor(color: string | number = ''): number {\n  if (isInteger(color)) {\n    return color;\n  }\n\n  if (typeof color === 'string') {\n    // Renderer expects RGBA values\n    if (color.startsWith('#')) {\n      return Number(\n        color.replace('#', '0x') + (color.length === 7 ? 'ff' : ''),\n      );\n    }\n\n    if (color.startsWith('0x')) {\n      return Number(color);\n    }\n    return Number('0x' + (color.length === 6 ? color + 'ff' : color));\n  }\n\n  return 0x00000000;\n}\n\n/**\n * Converts degrees to radians\n */\nexport function deg2rad(deg: number) {\n  return (deg * Math.PI) / 180;\n}\n"],"names":["activeElement","setActiveElement","createSignal","renderer","createShader","startLightningRenderer","options","driver","MainRenderDriver","RendererMain","rootId","bind","Children","Array","constructor","node","_parent","selected","firstChild","insert","beforeNode","index","indexOf","splice","push","parent","_isDirty","remove","nodeIndexToRemove","import","meta","env","MODE","isDev","config","debug","animationSettings","duration","easing","fontSettings","fontFamily","fontSize","log","msg","args","isObject","console","isFunc","item","isArray","isString","isNumber","isInteger","Number","keyExists","obj","keys","key","getAnimatableValue","value","States","callback","initialState","Object","entries","filter","_key","map","onChange","has","state","is","add","toggle","stateIndexToRemove","assertTruthy","condition","message","Error","children","i","length","c","name","width","height","numChildren","direction","flexDirection","dimension","crossDimension","marginOne","marginTwo","prop","crossProp","containerSize","containerCrossSize","itemSize","reduce","prev","gap","justify","justifyContent","align","alignItems","crossAlignChild","start","forEach","toPad","defaultAnimationSettings","convertEffectsToShader","styleEffects","effects","type","props","borderAccessor","set","color","get","LightningRendererNumberProps","LightningRendererNonAnimatingProps","ElementNode","lng","rendered","autofocus","_renderProps","x","y","defineProperty","v","_sendToLightningAnimatable","_sendToLightning","defineProperties","borderRadius","radius","_borderRadius","border","borderLeft","borderRight","borderTop","borderBottom","linearGradient","_linearGradient","_effects","shader","p","_shader","createAnimation","_animate","animate","setFocus","isTextNode","_resizeOnTextLoad","once","_node","loadedPayload","dimensions","updateLayout","getText","text","join","destroy","destroyNode","style","_style","hasChildren","states","_states","_stateChanged","_animationSettings","_applyZIndexToChildren","zIndex","zIndexIsInteger","parseInt","decimalSeparator","parseFloat","child","onBeforeLayout","call","display","calculateFlex","onLayout","forwardStates","slice","stateMapperHook","_undoStates","stylesToUndo","undoStyles","includes","newStyles","acc","styles","assign","render","createTextNode","onCreate","onLoad","on","_autosized","src","texture","isNaN","_width","_height","_color","createNode","onFail","Text","_el$","_$createElement","_$spread","View","renderTopDown","Canvas","init","root","createEffect","then","onFirstRender","catch","error","_ref$","_$use","_$setProp","_$insert","createRenderer$1","createElement","replaceText","insertNode","removeNode","setProperty","getParentNode","getFirstChild","getNextSibling","accessor","marker","initial","undefined","insertExpression","createRenderEffect","current","unwrapArray","t","multi","toString","cleanChildren","array","normalizeIncomingArray","replacement","appendNodes","reconcileArrays","replaceNode","normalized","unwrap","dynamic","len","parentNode","a","b","bLength","aEnd","bEnd","aStart","bStart","after","Map","sequence","removed","inserted","el","isParent","newNode","oldNode","spreadExpression","prevProps","skipChildren","ref","code","element","disposer","createRoot","dispose","spread","setProp","mergeProps","effect","memo","createMemo","createComponent","use","fn","arg","untrack","createRenderer","anchor","injectCSS","css","document","innerText","head","appendChild","updateRootStyleFromCanvas","canvas","bcr","getBoundingClientRect","settings","deviceLogicalPixelRatio","getElementById","left","offsetLeft","top","offsetTop","Math","ceil","transformOrigin","transform","attachInspector","setTimeout","universalLightning","dom","id","classList","origRender","clipping","overflow","_dom","solid","textNode","data","insertBefore","removeChild","loadInspector","solidRenderer","universalInspector","hexColor","startsWith","replace","deg2rad","deg","PI"],"mappings":"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","x_google_ignoreList":[6,12]}